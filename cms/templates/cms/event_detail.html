{% extends 'cms/base.html' %}

{% block title %}{{ event.name }} イベント詳細 | {% endblock %}

{% block ogp %}
<meta property="og:title" content="{{ event.name }}">
<meta property="og:type" content="article">
<meta property="og:url" content="{{ request.scheme }}://{{ request.get_host }}{% url 'cms:eve_de' event.id %}">
<meta property="og:locale" content="ja_JP">
<meta property="og:site_name" content="OnAcu（オンアク）">
{% if event.image %}
<meta property="og:image" content="{{ event.image.url }}">
<meta property="og:image:width" content="{{ event.image.width }}">
<meta property="og:image:height" content="{{ event.image.height }}">
<meta name="twitter:card" content="summary_large_image">
{% else %}
<meta name="twitter:card" content="summary">
{% endif %}
<meta name="twitter:site" content="@onacu_official">
{% endblock %}

{% block content %}
<div class="events">
  <div class="container pt-3">
    <h1 class="border-bottom pb-2">{{ event.name }}</h1>
    {% if error_message %}<div class="alert alert-danger" role="alert">{{ error_message }}</div>{% endif %}
    <div class="row">
      {% if event.image %}
      <div class="col-4 col-md-5 col-lg-6 text-center mb-3">
        <img class="img-fluid img-thumbnail" src="{{ event.image.url }}" alt="{{ event.name }}">
      </div>
      {% endif %}
      <div class="{{ event.image|yesno:'col-8 col-md-7 col-lg-6,col-12' }} mb-3">
        <ul class="list-group mb-2">
          <li class="list-group-item"><i class="fas fa-user"></i> <b>主催</b> {{ event.host.username }}</li>
          <li class="list-group-item"><i class="fas fa-calendar"></i> <b>日時</b> <a href="{% url 'cms:eve_ical' event.id %}">{{ event.date }}</a></li>
          <li class="list-group-item"><i class="fas fa-clock"></i> <b>時間</b> {{ event.personal_time }}秒</li>
          <li class="list-group-item"><i class="fas fa-ticket-alt"></i> <b>残り</b> {{ event.remains_ticket }}枚</li>
          <li class="list-group-item"><i class="fas fa-bullhorn"></i> <b>状態</b>
            {% if event.status == 0 %}
            {% if event.remains_ticket > 0 %}
            入手可能
            {% else %}
            完売
            {% endif %}
            {% elif event.status == 1 %}
            開催中
            {% elif event.status == 2 %}
            終了
            {% endif %}
          </li>
        </ul>
        {% if is_ticket %}
          {% if event.status != 2 and event.is_able_to_enter %}
            <a class="btn btn-info" href="{% url 'cms:eve_now' event.id %}">参加する</a>
          {% else %}
            <button class="btn btn-primary" disabled><i class="fas fa-ticket-alt"></i> 入手済み</button>
          {% endif %}
        {% elif event.status == 0 and event.remains_ticket > 0 and event.host != request.user %}
        <a class="btn btn-primary btn-lg" href="{% url 'cms:buy' event.id%}"><i class="fas fa-ticket-alt"></i> チケットの入手画面に進む</a>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}